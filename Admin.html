[Admin.html.txt](https://github.com/user-attachments/files/24463361/Admin.html.txt)
<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <style>
      .navbar-brand { font-weight: bold; }
      .container { margin-top: 30px; }
      .section-title { border-left: 5px solid #0d6efd; padding-left: 15px; margin-bottom: 20px; }
    </style>
    <script>
      // 1. å®‰å…¨æª¢æŸ¥ï¼šé€²å…¥é é¢ç«‹å³åŸ·è¡Œ
      (function() {
        const pwd = prompt("å®‰å…¨æª¢æŸ¥ï¼šè«‹è¼¸å…¥ç®¡ç†å“¡å¯†ç¢¼ä»¥é¡¯ç¤ºè³‡æ–™");
        if (pwd !== "sss555") {
          alert("å¯†ç¢¼éŒ¯èª¤ï¼å°‡è¿”å›é¦–é ã€‚");
          google.script.run.withSuccessHandler(url => {
            window.top.location.href = url + '?page=Index';
          }).getScriptUrl();
          document.documentElement.style.display = 'none';
        }
      })();
    </script>
  </head>
  <body class="bg-light">
    <nav class="navbar navbar-dark bg-dark shadow-sm">
      <div class="container-fluid">
        <span class="navbar-brand mb-0 h1">âš™ï¸ ç¤¾åœ˜ç®¡ç†å¾Œå°</span>
        <button class="btn btn-outline-light btn-sm" onclick="navToIndex()">è¿”å›é¦–é å…¥å£</button>
      </div>
    </nav>

    <div class="container bg-white shadow p-4 rounded">
      <h3 class="section-title text-secondary">ç”³è«‹åå–®ç®¡ç†</h3>
      <table class="table table-hover align-middle">
        <thead class="table-secondary">
          <tr>
            <th>å­¸è™Ÿ</th><th>å§“å</th><th>ç¤¾åœ˜</th><th>ç‹€æ…‹</th><th>æ“ä½œ</th>
          </tr>
        </thead>
        <tbody id="list-body">
          <tr><td colspan="5" class="text-center text-muted">è¼‰å…¥ä¸­...</td></tr>
        </tbody>
      </table>
    </div>

    <div class="container bg-white shadow p-4 rounded mt-4 mb-5">
      <h3 class="section-title text-secondary">ğŸ’¬ ç•™è¨€å¯©æ ¸ç®¡ç†</h3>
      <table class="table table-hover align-middle">
        <thead class="table-warning">
          <tr>
            <th>ç¤¾åœ˜</th><th>æš±ç¨±</th><th>å…§å®¹</th><th>æ™‚é–“</th><th>ç‹€æ…‹</th><th>æ“ä½œ</th>
          </tr>
        </thead>
        <tbody id="comments-body">
          <tr><td colspan="6" class="text-center text-muted">è¼‰å…¥ä¸­...</td></tr>
        </tbody>
      </table>
    </div>

    <script>
      // 2. é é¢åŠ è¼‰å¾ŒåŸ·è¡Œä¸€æ¬¡è¼‰å…¥
      window.onload = () => {
        loadAllData();
      };

      function loadAllData() {
        // åŒæ™‚æŠ“å–å…©ä»½è³‡æ–™
        google.script.run.withSuccessHandler(renderList).getAllApplications();
        google.script.run.withSuccessHandler(renderComments).adminGetComments();
      }

      // æ¸²æŸ“å ±ååå–®
     // åœ¨ Admin.html çš„ renderList å‡½å¼å…§ä¿®æ”¹
function renderList(data) {
  const tbody = document.getElementById('list-body');
  // ... å‰é¢åˆ¤æ–· data.length çš„éƒ¨åˆ†ç¶­æŒä¸è®Š ...
  let html = '';
  data.forEach(item => {
    // æ ¹æ“šç‹€æ…‹æ±ºå®šæ¨™ç±¤é¡è‰²
    let statusClass = 'bg-warning text-dark'; // é è¨­ å¾…è™•ç†
    if (item[4] === 'éŒ„å–') statusClass = 'bg-success';
    if (item[4] === 'æœªéŒ„å–') statusClass = 'bg-danger'; // æ–°å¢ç´…è‰²æ¨™ç±¤

    html += `<tr>
      <td>${item[1]}</td>
      <td>${item[2]}</td>
      <td>${item[3]}</td>
      <td><span class="badge ${statusClass}">${item[4]}</span></td>
      <td>
        <button class="btn btn-success btn-sm" onclick="changeStatus('${item[0]}','éŒ„å–')">éŒ„å–</button>
        <button class="btn btn-danger btn-sm" onclick="changeStatus('${item[0]}','æœªéŒ„å–')">ä¸éŒ„å–</button>
        <button class="btn btn-outline-secondary btn-sm" onclick="deleteItem('${item[0]}')">åˆªé™¤</button>
      </td>
    </tr>`;
  });
  tbody.innerHTML = html;
}

      // æ¸²æŸ“ç•™è¨€ç®¡ç†
      function renderComments(data) {
        const tbody = document.getElementById('comments-body');
        if (!data || data.length === 0) {
          tbody.innerHTML = '<tr><td colspan="6" class="text-center">ç›®å‰å°šç„¡ç•™è¨€</td></tr>';
          return;
        }
        let html = '';
        data.forEach(item => {
          const timeStr = item[4] ? new Date(item[4]).toLocaleString('zh-TW') : 'ç„¡æ™‚é–“';
          const isApproved = item[5] === 'approved';
          const statusBadge = isApproved ? 
            '<span class="badge bg-success">å·²æ ¸å‡†</span>' : 
            '<span class="badge bg-warning text-dark">å¾…å¯©æ ¸</span>';
          
          html += `<tr>
            <td>${item[1]}</td>
            <td>${item[2]}</td>
            <td><div style="max-width:200px; overflow:hidden; text-overflow:ellipsis;">${item[3]}</div></td>
            <td><small>${timeStr}</small></td>
            <td>${statusBadge}</td>
            <td>
              ${!isApproved ? `<button class="btn btn-success btn-sm" onclick="approveCommentItem('${item[0]}')">æ ¸å‡†</button>` : ''}
              <button class="btn btn-danger btn-sm" onclick="deleteCommentItem('${item[0]}')">åˆªé™¤</button>
            </td>
          </tr>`;
        });
        tbody.innerHTML = html;
      }

      // --- æ“ä½œåŠŸèƒ½ ---

      function changeStatus(id, status) {
        if(confirm('ç¢ºå®šå°‡æ­¤å­¸å“¡æ”¹ç‚ºéŒ„å–å—ï¼Ÿ')) {
          google.script.run.withSuccessHandler(() => loadAllData()).updateStatus(id, status);
        }
      }

      function deleteItem(id) {
        if(confirm('ç¢ºå®šè¦åˆªé™¤å ±åè³‡æ–™å—ï¼Ÿ')) {
          google.script.run.withSuccessHandler(() => loadAllData()).deleteApplication(id);
        }
      }

      function approveCommentItem(id) {
        google.script.run.withSuccessHandler(() => loadAllData()).approveComment(id);
      }

      function deleteCommentItem(id) {
        if(confirm('ç¢ºå®šè¦åˆªé™¤ç•™è¨€å—ï¼Ÿ')) {
          google.script.run.withSuccessHandler(() => loadAllData()).deleteComment(id);
        }
      }

      function navToIndex() {
        google.script.run.withSuccessHandler(url => {
          window.top.location.href = url + '?page=Index';
        }).getScriptUrl();
      }
    </script>
  </body>
</html>
